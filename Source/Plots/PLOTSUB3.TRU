EXTERNAL   !PLOTSUB3.TRU!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOT5( COLOR$ )  DIM F(0:100)  DIM FOLD(0:100)  DIM B(32)  DIM FACTOR(32)  DIM PROD(100,16)  OPTION ANGLE RADIANS  LET SHOWFLAG = 1  LET B(1)  = -.636588  LET B(3)  = -.212111  LET B(5)  = -.127164  LET B(7)  = -9.07219E-2  LET B(9)  = -7.04477E-2  LET B(11) = -5.75225E-2  LET B(13) = -4.85546E-2  LET B(15) = -4.19609E-2  LET B(17) = -3.69034E-2  LET B(19) = -3.28969E-2  LET B(21) = -2.96411E-2  LET B(23) = -2.69402E-2  LET B(25) = -2.46608E-2  LET B(27) = -2.27093E-2  LET B(29) = -2.10177E-2  LET B(31) = -1.95357E-2  LET GETOUT = 0  LET XMIT = 1  DO    LET CLEARONCE = 1    LET CYCLE = 0    CLEAR    SET WINDOW 0, 81, 0, 31    SET TEXT JUSTIFY "CENTER", "HALF"    PLOT TEXT, AT 40,29 : "THIS PROGRAM MODELS THE TRANSMISSION OF A ""ONE"" ALONG A TELEGRAPH LINE"    PLOT TEXT, AT 40,27 : "THE INITIAL CONDITION ON THE LINE IS ""ZERO"""    PLOT TEXT, AT 40,25 : "THE PROGRAM USES A FOURIER SERIES BASED ON AN OPEN CIRCUIT AT THE FAR END"    CALL PLOTFRAME50    PLOT TEXT, AT 0,1.35 : "10 VOLTS"    PLOT TEXT, AT 0,1.20 : "HERE"    BOX CLEAR .39,.61,.9,1.1    PLOT TEXT, AT .5,1 : " telegraph line "    LET CLEARFLAG = 0    CALL CQ( RESULT )    IF RESULT = 1 THEN      LET X$ = "C"    ELSE IF RESULT = 2 THEN      LET X$ = "Q"    END IF    IF X$ = "Q" THEN LET GETOUT = 1             !EXIT TO MAIN MENU    IF GETOUT = 0 THEN      CLEAR      CALL PLOTFRAME5      SET WINDOW 0, 81, 0, 31      PLOT TEXT, AT 40,29 : "PLEASE WAIT"      SET WINDOW -.1, 1.1, -1, 3      PAUSE 1      FOR N = 1 TO 16        LET Z = 2*N-1        LET FACTOR(N) = (Z*PI/2)^2      NEXT N      FOR I = 1 TO 99 STEP 1        LET X = I/100        LET PIX = PI*X/2        FOR N = 1 TO 16          LET Z = 2*N-1          LET PROD(I,N) = B(Z)*SIN(Z*PIX)        NEXT N      NEXT I      DO                            !RETURN HERE IF CYCLE2 = 1        LET CYCLE = 0        LET CYCLE2 = 0        CALL PLOTFRAME5        BOX CLEAR 0, 1, 2, 3        LET MESSAGE$ = "NUMBER OF TERMS IN FOURIER SERIES"        LET MESSAGE$ = MESSAGE$ & "|" & " (an integer " & CHR$(179) & " 1 and " & CHR$(178) & " 16) ?"        LET HAW = 0        LET CSX = 0        DO          IF HAW = 1 THEN CALL MACSYSBEEP(1)          CALL INPUTVALL( MESSAGE$, K, SHOWFLAG, FLAG )          IF FLAG = 1 OR (K >= 1 AND K = INT(K) AND K <= 16) THEN LET CSX = 1          LET HAW = 1        LOOP UNTIL CSX = 1        IF FLAG = 1 THEN          LET CYCLE = 1          CALL CQ( RESULT )          IF RESULT = 1 THEN            LET CYCLE2 = 1          ELSE IF RESULT = 2 THEN            LET GETOUT = 1            LET CYCLE  = 0            LET CYCLE2 = 0          END IF        END IF        IF CYCLE = 0 AND GETOUT = 0 THEN          IF CLEARONCE = 1 THEN            LET CLEARONCE = 0            CLEAR          END IF          CALL PLOTFRAME5          FOR I = 1 TO 100 STEP 1            LET FOLD(I) = F(I)            LET F(I) = 0            FOR N = 1 TO K              LET F(I) =  F(I) + PROD(I,N)            NEXT N          NEXT I          IF WW = 0 THEN            FOR X = 0 TO 1 STEP 1/100              LET I = 100*X              SET COLOR "WHITE"              PLOT X, 0;              PLOT X, 1 + 2*FOLD(I)              CALL SETCOLOR( COLOR$ )              PLOT X, 0;              PLOT X, 1 + 2*F(I)            NEXT X!            SOUND 2000,.1            PLOT   0,  1;            PLOT   1,  1            SET WINDOW 0, 81, 0, 31            BOX CLEAR 15, 65, 3,  5            IF K = 8 OR K = 11 OR K = 18 OR (K >= 80 AND K <= 89) THEN              LET STRING$ = "  THIS IS AN " & STR$(K) & "-TERM PLOT   "            ELSE              LET STRING$ = "  THIS IS A " & STR$(K) & "-TERM PLOT   "            END IF            SET TEXT JUSTIFY "CENTER", "HALF"            PLOT TEXT, AT 41,4 :  STRING$            SET WINDOW -.1, 1.1, -1, 3            DO                      !RETURN HERE IF CYCLE3 = 1              LET CYCLE3 = 0              CALL ASQ( RESULT )  !ANOTHER PLOT/START THE CLOCK/QUIT              IF RESULT = 1 THEN                LET ZZ$ = "P"              ELSE IF RESULT = 2 THEN                LET ZZ$ = "C"              ELSE IF RESULT = 3 THEN                LET ZZ$ = "Q"              END IF              IF ZZ$ = "Q" OR ZZ$ = "P" THEN LET CYCLE2 = 1   !RETURN TO "HOW MANY TERMS"              IF CYCLE2 = 0 THEN                DO                  LET CYCLE4 = 0                  SET WINDOW 0, 81, 0, 31                  BOX CLEAR 0, 81, 28.5, 29.5                  PLOT TEXT, AT 40,29 : "THE FUNCTION PLOTTED BELOW REPRESENTS THE INITIAL VOLTAGE ON THE LINE"                  SET WINDOW -.1, 1.1, -1, 3                  LET MESSAGE$ = "TIME GROWS LINEARLY OR EXPONENTIALLY ?"                  LET ICON = 2                  LET BUTTON$ = "LIN|EXP|QUIT"                  CALL TW_DWARN(ICON, MESSAGE$, BUTTON$, DEFAULT, RESULT)                  IF RESULT = 1 THEN                    LET LE$ = "L"                  ELSE IF RESULT = 2 THEN                    LET LE$ = "E"                  ELSE IF RESULT = 3 THEN                    LET LE$ = "Q"                  END IF                  IF LE$ = "Q" THEN LET CYCLE3 = 1   !RETURN TO "START THE CLOCK"                  IF CYCLE3 = 0 THEN                    IF LE$ = "L" THEN                      LET MESSAGE$ = "WHAT SIZE TIME STEP"                      LET MESSAGE$ = MESSAGE$ & "|" & "  (a positive number, try 3) ?"                      LET FUZ = 0                      LET GUZ = 0                      DO                        IF FUZ = 1 THEN CALL MACSYSBEEP(1)                        CALL INPUTVALL( MESSAGE$, AT, SHOWFLAG, FLAG )                        IF FLAG = 1 OR AT > 0 THEN LET GUZ = 1                        LET FUZ = 1                      LOOP UNTIL GUZ = 1                      LET DT = .01 * AT                      IF FLAG = 1 THEN LET CYCLE4 = 1                    ELSE IF LE$ = "E" THEN                      LET MESSAGE$ = "WHAT VALUE FOR THE EXPONENT"                      LET MESSAGE$ = MESSAGE$ & "|" & "  (a number >1 and " & CHR$(178) & " 2) ?"                      LET BUZ = 0                      LET RUZ = 0                      DO                        IF BUZ = 1 THEN CALL MACSYSBEEP(1)                        CALL INPUTVALL( MESSAGE$, BT, SHOWFLAG, FLAG )                        IF FLAG = 1 OR (BT > 1 AND BT <= 2) THEN LET RUZ = 1                        LET BUZ = 1                      LOOP UNTIL RUZ = 1                      LET DT = BT                      IF FLAG = 1 THEN LET CYCLE4 = 1                    END IF                    IF CYCLE4 = 0 THEN                      LET T = 0                      LET HALT = 0                      LET XMIT = 1                      LET XMITOLD = 1                      DO                        LET GATE = 0                        LET T = 0                        LET CLEARSWITCH = 0                        LET KK = K                        DO                          CALL PLOTFRAME5                          IF XMIT = 1 AND XMITOLD = 0 THEN                            FOR X = .01 TO 1 STEP .01                              SET COLOR "WHITE"                              PLOT X, .01;                              PLOT X, .99                            NEXT X                          END IF                          CALL SETCOLOR( COLOR$ )                          PLOT  -.02,   0;                          PLOT  1.02,   0                          PLOT     0, -.1;                          PLOT     0,  1.1                          PLOT     1, -.1;                          PLOT     1,  1.1                          PLOT     0,   1;                          PLOT     1,   1                          IF CLEARSWITCH = 0 THEN                            LET CLEARSWITCH = 1                          END IF                          IF LE$ = "L" THEN                            LET TURNOFF = .2                          ELSE IF LE$ = "E" THEN                            LET TURNOFF = .1                          END IF                          IF EXP(-T) < TURNOFF THEN                            LET HALT = 1!                            SOUND 2000,.1                          END IF                          IF HALT = 0 THEN                            SET WINDOW 0, 81, 0, 31                            BOX CLEAR 0,81,28.5,29.5                            PLOT TEXT, AT 40,29 : "PLEASE WAIT...  PRESS SPACEBAR TO TERMINATE"                            SET WINDOW -.1, 1.1, -1, 3                            FOR I = 1 TO 100                              LET FOLD(I) = F(I)                            NEXT I                            LET GATE = GATE + 1                            FOR I = 1 TO 100 STEP 1                              LET F(I) = 0                              LET X = I/100                              LET PIX = PI*X/2                              FOR N = 1 TO KK                                LET F(I) = F(I) + PROD(I,N)*EXP(-T*FACTOR(N))                              NEXT N                              IF KEY INPUT THEN                                GET KEY INKEY                                IF INKEY = 32 THEN                                  LET CYCLE2 = 1                                  CALL RESTART                                  EXIT FOR                                END IF                              END IF                            NEXT I                            IF CYCLE2 = 0 THEN                              LET START = .01                              LET FIN =   1                              LET DELTA = .01                              FOR X = START TO FIN STEP DELTA                                SET COLOR "WHITE"                                PLOT X, 0;                                IF XMIT = 1 AND XMITOLD = 1 THEN                                  PLOT X, 1 + 2*FOLD(100*X)                                ELSE IF XMIT = 1 AND XMITOLD = 0 THEN                                  PLOT X, -2*FOLD(100*X)                                ELSE IF XMIT = 0 AND XMITOLD = 1 THEN                                  PLOT X, 1 + 2*FOLD(100*X)                                ELSE IF XMIT = 0 AND XMITOLD = 0 THEN                                  PLOT X, -2*FOLD(100*X)                                END IF                                CALL SETCOLOR( COLOR$ )                                PLOT X, 0;                                IF XMIT = 1 THEN                                  PLOT X, 1 + 2*F(100*X)                                ELSE IF XMIT = 0 THEN                                  PLOT X, -2*F(100*X)                                END IF                                IF KEY INPUT THEN                                  GET KEY INKEY                                  IF INKEY = 32 THEN                                    LET CYCLE2 = 1                                    CALL RESTART                                    EXIT FOR                                  END IF                                END IF                              NEXT X                              LET STOPIT = 0                              LET J = 0                              DO                                LET J = J + 1                                IF EXP(- T*FACTOR(J)) < 0.01 * EXP( -T*(PI/2)^2 ) THEN                                  LET KK = J                                  LET STOPIT = 1                                END IF                              LOOP UNTIL STOPIT = 1 OR J = KK                              SET WINDOW 0, 81, 0, 31                              BOX CLEAR 15, 65, 3,  5                              LET STRING$ = "T = " & STR$(INT(1000*T + .5)/10)                              SET TEXT JUSTIFY "CENTER", "HALF"                              PLOT TEXT, AT 40,4 : STRING$                              SET WINDOW -.1, 1.1, -1, 3                              LET XMITOLD = XMIT                              IF LE$ = "E" THEN                                LET T = DT*T + .0005                              ELSE IF LE$ = "L" THEN                                LET T = T + DT                              END IF                            END IF                          END IF                        LOOP UNTIL HALT = 1 OR CYCLE2 = 1                        IF HALT = 1 THEN                          LET HALT = 0                          IF XMIT = 1 THEN                            SET WINDOW 0, 81, 0, 31                            BOX CLEAR 0,81,28.5,29.5                            PLOT TEXT, AT 35,29 : "TRANSMISSION COMPLETE: TRANSMIT A ZERO"                            PLOT 54,29.5 ; 56,29.5 ; 56,28.5 ; 54,28.5 ; 54,29.5                            PLOT TEXT, AT 59.5,29 : "QUIT"                            PLOT 62,29.5 ; 64,29.5 ; 64,28.5 ; 62,28.5 ; 62,29.5                            DO                              CALL TW_EVENT(TIMER, TYPE1$, WINDOW, X1, X2)                              IF TYPE1$ = "SINGLE" THEN                                IF X1>54 AND X1<56 AND X2>28.5 AND X2<29.5 THEN                                  CALL STAR(55,29)                                  LET SIG$ = "Z"                                  EXIT DO                                ELSE IF X1>62 AND X1<64 AND X2>28.5 AND X2<29.5 THEN                                  CALL STAR(63,29)                                  LET SIG$ = "Q"                                  EXIT DO                                ELSE                                  CALL MACSYSBEEP(1)                                END IF                              END IF                            LOOP                            SET WINDOW -.1, 1.1, -1, 3                            IF SIG$ = "Z" THEN                              LET XMIT = 0                            ELSE IF SIG$ = "Q" THEN                              LET CYCLE2 = 1                              CALL RESTART                            END IF                          ELSE IF XMIT = 0 THEN                            SET WINDOW 0, 81, 0, 31                            BOX CLEAR 0,81,28.5,29.5                            PLOT TEXT, AT 35,29 : "TRANSMISSION COMPLETE:  TRANSMIT A ONE"                            PLOT 54,29.5 ; 56,29.5 ; 56,28.5 ; 54,28.5 ; 54,29.5                            PLOT TEXT, AT 59.5,29 : "QUIT"                            PLOT 62,29.5 ; 64,29.5 ; 64,28.5 ; 62,28.5 ; 62,29.5                            DO                              CALL TW_EVENT(TIMER, TYPE1$, WINDOW, X1, X2)                              IF TYPE1$ = "SINGLE" THEN                                IF X1>54 AND X1<56 AND X2>28.5 AND X2<29.5 THEN                                  CALL STAR(55,29)                                  LET SIG$ = "W"                                  EXIT DO                                ELSE IF X1>62 AND X1<64 AND X2>28.5 AND X2<29.5 THEN                                  CALL STAR(63,29)                                  LET SIG$ = "Q"                                  EXIT DO                                ELSE                                  CALL MACSYSBEEP(1)                                END IF                              END IF                            LOOP                            SET WINDOW -.1, 1.1, -1, 3                            IF SIG$ = "W" THEN                              LET XMIT = 1                            ELSE IF SIG$ = "Q" THEN                              LET CYCLE2 = 1                              CALL RESTART                            END IF                          END IF                        END IF                      LOOP UNTIL XMIT = 2 OR CYCLE2 = 1                    END IF                  END IF                LOOP WHILE CYCLE4 = 1              END IF            LOOP WHILE CYCLE3 = 1          END IF        END IF      LOOP WHILE CYCLE2 = 1    END IF  LOOP WHILE CYCLE = 1!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB RESTART  LET CLEARONCE = 1  LET XMIT = 1  CALL PLOTFRAME5END SUB !RESTART!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOTFRAME50  SET WINDOW -.1, 1.1, -1, 3  PLOT -.05,  0; 1.05,  0    !X-AXIS  PLOT   0,   0;    0, .4    !THE BATTERY  PLOT -.02, .4;  .02, .4  PLOT -.04, .5;  .04, .5  PLOT -.02, .6;  .02, .6  PLOT -.04, .7;  .04, .7  PLOT   0,  .7;    0,  1  PLOT   0,   1; .025,  1    !THE WIRING FOR THE TELEGRAPH KEY  PLOT .025,  1; .025,  1.05  BOX AREA .025, .08, 1.05, 1.06  !THE TELEGRAPH KEY  PLOT  .075,1.06 ; .075,1.1  PLOT  .07 ,1.1  ; .08 ,1.1  BOX AREA 0.073, .078, 1, 1.02  BOX AREA 0.07, 1, .98, 1   !THE TELEGRAPH LINE  PLOT   1,   0;   1,  .2    !OPEN CIRCUIT AT FAR END  PLOT   1,   1;   1,  .8  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT TEXT, AT 1,1.35 : "OPEN CCT"  PLOT TEXT, AT 1,1.20 : "HERE"  PLOT TEXT, AT 0,-.32 : "TRANSMITTING"  PLOT TEXT, AT 0,-.47 : "END"  PLOT TEXT, AT 1,-.32 : "RECEIVING"  PLOT TEXT, AT 1,-.47 : "END"END SUB !PLOTFRAME50!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOTFRAME5  SET WINDOW -.1, 1.1, -1, 3  PLOT -.02,  0;  PLOT 1.02,  0  PLOT   0,  -.1;  PLOT   0,   1.1  PLOT   1, -.1;  PLOT   1,   1.1  PLOT   0,   1;  PLOT   1,   1  SET TEXT JUSTIFY "CENTER", "HALF"  IF XMIT = 1 THEN    LET STRING1$ = "10 VOLTS"  ELSE IF XMIT = 0 THEN    LET STRING1$ = "0 VOLTS "  END IF  BOX CLEAR -.1,.15, 1.3, 1.4  PLOT TEXT, AT 0,1.35 : STRING1$  PLOT TEXT, AT 0,1.20 : "HERE"  PLOT TEXT, AT 1,1.35 : "OPEN CCT"  PLOT TEXT, AT 1,1.20 : "HERE"  PLOT TEXT, AT 0,-.32 : "TRANSMITTING"  PLOT TEXT, AT 0,-.47 : "END"  PLOT TEXT, AT 1,-.32 : "RECEIVING"  PLOT TEXT, AT 1,-.47 : "END"END SUB !PLOTFRAME5!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!END SUB !PLOT5!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOT6( COLOR$ )  OPTION ANGLE RADIANS  DIM T(100)  DIM F(0:100, 0:100)  DIM FIRST(100)  DIM LAST(100)  DIM DELT(100)  LET SHOWFLAG = 1  DO    LET DOCLEAR = 1    LET CYCLE = 0    LET CYCLE2 = 0    SET WINDOW 0, 81, 0, 31    SET TEXT JUSTIFY "CENTER", "HALF"    CLEAR    PLOT TEXT, AT 40,29 : "THIS PROGRAM PLOTS THE FUNCTION"    PLOT TEXT, AT 40,27 : "          0   (  0 < x < .4 )"    PLOT TEXT, AT 40,26 : "v(x)  =   1   ( .4 < x < .6 )"    PLOT TEXT, AT 40,25 : "          0   ( .6 < x <  1 )"    PLOT TEXT, AT 40,23 : "AND THEN USES IT AS THE INITIAL CONDITION FOR THE WAVE EQUATION"    CALL PLOTFRAME61    CALL CQ( RESULT )    IF RESULT = 1 THEN      LET X$ = "C"    ELSE IF RESULT = 2 THEN      LET X$ = "Q"    END IF    IF X$ = "Q" THEN LET GETOUT = 1    IF GETOUT = 0 THEN      DO        LET CYCLE = 0        LET CYCLE2 = 0        LET MESSAGE$ = "NUMBER OF TERMS IN FOURIER SERIES"        LET MESSAGE$ = MESSAGE$ & "|" & "  (a positive integer) ?"        LET CAM = 0        LET SAM = 0        DO          IF CAM = 1 THEN CALL MACSYSBEEP(1)          CALL INPUTVALL( MESSAGE$, K, SHOWFLAG, FLAG )          IF FLAG = 1 OR (K >=1 AND K = INT(K)) THEN LET SAM = 1          LET CAM = 1        LOOP UNTIL SAM = 1        IF FLAG = 1 THEN          LET CYCLE = 1          LET CYCLE2 = 1          CALL CQ( RESULT )          IF RESULT = 2 THEN            LET GETOUT = 1            LET CYCLE  = 0            LET CYCLE2 = 0          END IF        END IF        IF CYCLE = 0 AND GETOUT = 0 THEN          IF K > 10 THEN            LET STRING$ = "PLEASE WAIT...  PRESS SPACEBAR TO TERMINATE"            SET WINDOW 0, 81, 0, 31            IF DOCLEAR = 1 THEN              BOX CLEAR 10, 70, 22.5, 29.5              LET DOCLEAR = 0            ELSE IF DOCLEAR = 0 THEN              BOX CLEAR 10, 70, 28.5, 29.5            END IF            PLOT TEXT, AT 40, 29 : STRING$            SET WINDOW -10, 110, -1.5, 1.7          END IF          LET DOCLEAR = 0          LET Y = 1          LET YOLD = 0          FOR I = 50 TO 0 STEP -1            LET F(I,YOLD) = F(I,Y)          NEXT I          FOR X = 50 TO 0 STEP -1            LET F(X,Y) = 0            FOR N = 1 TO K              IF KEY INPUT THEN                GET KEY INKEY                IF INKEY = 32 THEN                  LET CYCLE2 = 1                  EXIT FOR                END IF              ELSE                LET M = 2*N - 1                LET F(X,Y) = F(X,Y) + (2/PI) * (COS(.4*M*PI)-COS(.6*M*PI)) * (SIN(M*PI*(X/100))/M)              END IF            NEXT N            IF CYCLE2 = 1 THEN EXIT FOR          NEXT X          IF CYCLE2 = 0 THEN            CLEAR            CALL PLOTFRAME6            FOR X = 50 TO 0 STEP -1              IF KEY INPUT THEN                GET KEY INKEY                IF INKEY = 32 THEN                  LET CYCLE2 = 1                  EXIT FOR                END IF              ELSE                SET COLOR "WHITE"                PLOT X, 0;                PLOT X, F(X,YOLD)                PLOT 100-X, 0;                PLOT 100-X, F(X,YOLD)                CALL SETCOLOR( COLOR$ )                PLOT X, 0;                PLOT X, F(X,Y)                PLOT 100-X, 0;                PLOT 100-X, F(X,Y)              END IF            NEXT X            IF CYCLE2 = 0 THEN!              SOUND 2000,.1              IF K = 8 OR K = 11 OR K = 18 THEN                LET STRING$ = "THIS IS AN " &  STR$(K) & " TERM PLOT"              ELSE                LET STRING$ = "THIS IS A " & STR$(K)  & " TERM PLOT"              END IF              SET WINDOW 0, 81, 0, 31              BOX CLEAR 15, 65, 6, 8              PLOT TEXT, AT 40, 7 : STRING$              SET WINDOW -10, 110, -1.5, 1.7              DO                LET CYCLE3 = 0                CALL PLOTFRAME6                SET WINDOW 0, 81, 0, 31                BOX CLEAR 0, 81, 27.5, 31                SET WINDOW -10, 110, -1.5, 1.7                CALL ASQ( RESULT )   !!!!!!!!!!!!!!!!!!!!!!!!!!!                SET WINDOW -10, 110, -1.5, 1.7                IF RESULT = 1 THEN                  LET R$ = "P"                ELSE IF RESULT = 2 THEN                  LET R$ = "C"                ELSE IF RESULT = 3 THEN                  LET R$ = "Q"                END IF                IF R$ = "Q" OR R$ = "P" THEN LET CYCLE2 = 1                IF CYCLE2 = 0 THEN                  DO                    LET CYCLE4 = 0                    SET WINDOW 0, 81, 0, 31                    PLOT TEXT, AT 40,29 : "THE FUNCTION SHOWN BELOW REPRESENTS THE INITIAL VOLTAGE ON THE LINE"                    SET WINDOW -10, 110, -1.5, 1.7                    LET MESSAGE$ = "HOW MANY PLOTS (an integer >0 and " & CHR$(178) & " 100) ?"                    LET CUT = 0                    LET RUT = 0                    DO                      IF CUT = 1 THEN CALL MACSYSBEEP(1)                      CALL INPUTVALL( MESSAGE$, GG, SHOWFLAG, FLAG )                      IF FLAG = 1 OR (GG > 0 AND GG <= 100 AND GG = INT(GG)) THEN LET RUT = 1                    LOOP UNTIL RUT = 1                    IF FLAG = 1 THEN LET CYCLE3 = 1                    IF CYCLE3 = 0 THEN                      LET MESSAGE$ = "WHAT SIZE TIME STEP"                      LET MESSAGE$ = MESSAGE$ & "|" & "  (a positive number, try 4) ?"                      LET SAM = 0                      LET RAM = 0                      DO                        IF SAM = 1 THEN CALL MACSYSBEEP(1)                        CALL INPUTVALL( MESSAGE$, BB, SHOWFLAG, FLAG )                        IF FLAG = 1 OR BB > 0 THEN LET RAM = 1                        LET SAM = 1                      LOOP UNTIL RAM = 1                      IF FLAG = 1 THEN LET CYCLE4 = 1                      IF CYCLE4 = 0 THEN                        LET TT = 0                        SET WINDOW 0, 81, 0, 31                        BOX CLEAR 10, 70, 6.5, 7.5                        LET STRING$ = "PLEASE WAIT...  PRESS SPACEBAR TO TERMINATE"                        BOX CLEAR 0, 81, 28.5, 29.5                        PLOT TEXT, AT 40, 29 : STRING$                        SET WINDOW -10, 110, -1.5, 1.7                        LET CLEARONCE = 1                        FOR Y = 1 TO GG                          LET T(Y) = TT                          LET TESTVAL = INT((PI*T(Y)/100)/(PI/2))                          IF MOD(TESTVAL,4) = 0 THEN                            LET FIRST(Y) = 50                            LET LAST(Y) = 0                            LET DELT(Y) = -1                          ELSE IF MOD(TESTVAL,4) = 1 THEN                            LET FIRST(Y) = 0                            LET LAST(Y) = 50                            LET DELT(Y) = 1                          ELSE IF MOD(TESTVAL,4) = 2 THEN                            LET FIRST(Y) = 50                            LET LAST(Y) = 0                            LET DELT(Y) = -1                          ELSE IF MOD(TESTVAL,4) = 3 THEN                            LET FIRST(Y) = 0                            LET LAST(Y) = 50                            LET DELT(Y) = 1                          END IF                          LET N = 0                          FOR X = FIRST(Y) TO LAST(Y) STEP DELT(Y)                            LET F(X,Y) = 0                            DO                              LET N = N + 1                              LET M = 2*N - 1                              LET Z = -(M^2)*T(Y)                              LET F(X,Y) = F(X,Y) + (2/PI) * (COS(.4*M*PI)-COS(.6*M*PI)) * (SIN(M*PI*(X/100))/M) * COS(M*PI*T(Y)/100)                            LOOP UNTIL N = K                            LET N = 0                          NEXT X                          IF CLEARONCE = 1 THEN                            CLEAR                            CALL PLOTFRAME6                            LET STRING$ = "PLEASE WAIT...  PRESS SPACEBAR TO TERMINATE"                            BOX CLEAR 0, 81, 28.5, 29.5                            PLOT TEXT, AT 40, 29 : STRING$                            SET WINDOW -10, 110, -1.5, 1.7                            LET CLEARONCE = 0                          END IF                          FOR X = FIRST(Y) TO LAST(Y) STEP DELT(Y)                            IF Y > 1 THEN                              SET COLOR "WHITE"                              PLOT X, 0;                              PLOT X, F(X,Y-1)                              PLOT 100-X, 0;                              PLOT 100-X, F(X,Y-1)                            END IF                            CALL SETCOLOR( COLOR$ )                            PLOT X, 0;                            PLOT X, F(X,Y)                            PLOT 100-X, 0;                            PLOT 100-X, F(X,Y)                            IF KEY INPUT THEN                              GET KEY INKEY                              IF INKEY = 32 THEN                                LET CYCLE2 = 1                                EXIT FOR                              END IF                            END IF                          NEXT X                          CALL PLOTFRAME6                          IF CYCLE2 = 1 THEN EXIT FOR                          SET WINDOW 0, 81, 0, 31                          LET STRING1$ = "PLEASE WAIT...  PRESS SPACEBAR TO TERMINATE"                          BOX CLEAR 0, 81, 28.5, 29.5                          PLOT TEXT, AT 40, 29 : STRING1$                          LET STRING2$ = "PLOT " & STR$(Y) & " OF " & STR$(GG) & "    T = " & STR$(T(Y))                          BOX CLEAR 10, 70, 27.5, 28.5                          PLOT TEXT, AT 40, 28 : STRING2$                          SET WINDOW -10, 110, -1.5, 1.7                          LET TT = TT + BB                        NEXT Y!                        SOUND 2000,.1                        IF CYCLE2 = 0 THEN                          DO                            CALL PLOTFRAME6                            LET CYCLE5 = 0                            CALL AMQ( RESULT )                            IF RESULT = 1 THEN                              LET RUN$ = "A"                            ELSE IF RESULT = 2 THEN                              LET RUN$ = "M"                            ELSE IF RESULT = 3 THEN                              LET RUN$ = "Q"                            END IF                            IF RUN$ = "Q" THEN                              LET CYCLE2 = 1                              SET WINDOW 0, 81, 0, 31                              BOX CLEAR 10, 70, 27.5, 28.5                              SET WINDOW -10, 110, -1.5, 1.7                            END IF                            IF CYCLE2 = 0 THEN                              IF RUN$ = "M" THEN                                LET Y = 1                                CLEAR                                DO                                  CALL PLOTFRAME6                                  FOR X = FIRST(Y) TO LAST(Y) STEP DELT(Y)                                    IF Y > DY THEN                                      SET COLOR "WHITE"                                      PLOT X, 0;                                      PLOT X, F(X,Y-DY)                                      PLOT 100-X, 0;                                      PLOT 100-X, F(X,Y-DY)                                    END IF                                    CALL SETCOLOR( COLOR$ )                                    PLOT X, 0;                                    PLOT X, F(X,Y)                                    PLOT 100-X, 0;                                    PLOT 100-X, F(X,Y)                                  NEXT X                                  CALL PLOTFRAME6                                  LET STRING$ = "PLOT " & STR$(Y) & " OF " & STR$(GG) & "    T = " & STR$(T(Y))                                  SET WINDOW 0, 81, 0, 31                                  BOX CLEAR 10, 70, 27.5, 28.5                                  PLOT TEXT, AT 40, 28 : STRING$                                  SET WINDOW -10, 110, -1.5, 1.7                                  CALL CQ( RESULT )                                  IF RESULT = 2 THEN                                    LET CYCLE5 = 1                                    LET CYCLE2 = 0                                    EXIT DO                                  END IF                                  SET WINDOW -10, 110, -1.5, 1.7                                  LET MESSAGE$ = "POSITIVE OR NEGATIVE INTEGER"                                  LET CAP = 0                                  LET ZAP = 0                                  DO                                    IF CAP = 1 THEN CALL MACSYSBEEP(1)                                    CALL INPUTVALL( MESSAGE$, DY, SHOWFLAG, FLAG )                                    IF FLAG = 1 OR ABS(DY) = INT(ABS(DY)) THEN LET ZAP = 1                                    LET CAP = 1                                  LOOP UNTIL ZAP = 1                                  IF FLAG = 1 THEN LET CYCLE5 = 1                                  IF CYCLE5 = 0 THEN                                    IF DY > 0 THEN                                      IF DY > GG - Y THEN                                        LET DY = GG - Y                                        CALL MACSYSBEEP(1)                                      END IF                                    ELSE IF DY < 0 THEN                                      IF DY < 1 - Y THEN                                        LET DY = 1 - Y                                        CALL MACSYSBEEP(1)                                      END IF                                    END IF                                    LET Y = Y + DY                                  END IF                                LOOP UNTIL FLAG = 1                              ELSE IF RUN$ = "A" THEN                                CLEAR                                FOR Y = 1 TO GG                                SET WINDOW 0, 81, 0, 31                                LET STRING$ = "PRESS SPACEBAR TO TERMINATE"                                BOX CLEAR 0, 81, 28.5, 29.5                                PLOT TEXT, AT 40, 29 : STRING$                                SET WINDOW -10, 110, -1.5, 1.7                                  CALL PLOTFRAME6                                  FOR X = FIRST(Y) TO LAST(Y) STEP DELT(Y)                                    IF Y > 1 THEN                                      SET COLOR "WHITE"                                      PLOT X, 0;                                      PLOT X, F(X,Y-1)                                      PLOT 100-X, 0;                                      PLOT 100-X, F(X,Y-1)                                    END IF                                    CALL SETCOLOR( COLOR$ )                                    PLOT X, 0;                                    PLOT X, F(X,Y)                                    PLOT 100-X, 0;                                    PLOT 100-X, F(X,Y)                                    IF KEY INPUT THEN                                      GET KEY INKEY                                      IF INKEY = 32 THEN                                        LET X = LAST(Y)                                        LET Y = GG                                        LET BYPASS = 1                                      END IF                                    END IF                                  NEXT X                                  IF BYPASS = 0 THEN                                    LET STRING$ = "PLOT " & STR$(Y) & " OF " & STR$(GG) & "    T = " & STR$(T(Y))                                    SET WINDOW 0, 81, 0, 31                                    BOX CLEAR 10, 70, 27.5, 28.5                                    PLOT TEXT, AT 40, 28 : STRING$                                    SET WINDOW -10, 110, -1.5, 1.7                                  END IF                                  LET BYPASS = 0                                NEXT Y!                                SOUND 2000,.1                                LET CYCLE5 = 1                              END IF                            END IF                          LOOP WHILE CYCLE5 = 1 AND CYCLE2 = 0                          LET CYCLE5 = 0                        END IF                      END IF                    END IF                  LOOP WHILE CYCLE4 = 1                END IF              LOOP WHILE CYCLE3 = 1            END IF          END IF        END IF      LOOP WHILE CYCLE2 = 1    END IF  LOOP WHILE CYCLE = 1END SUB !PLOT6!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOTFRAME6  SET WINDOW -10, 110, -1.5, 1.7  PLOT   -5,    0;    105,    0  PLOT   40, 0;  40, 1;  60, 1;  60, 0  PLOT    0, -1;    0,  1  PLOT  100, -1;  100,  1  PLOT 40, 0; 40, 1; 60, 1; 60, 0END SUB !PLOTFRAME6!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOTFRAME61  SET WINDOW -10, 110, -2, 5  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT   -5,    0;    105,    0  PLOT    0, -1.3;      0,  2.5  PLOT  100, -1.3;    100,  2.5  PLOT   40, 0;  40, 2;  60, 2;  60, 0  PLOT TEXT, AT   -4,  2.2 : "v(x)"  PLOT TEXT, AT  1.5, -.15 : "0"  PLOT TEXT, AT 39.5, -.15 : ".4"  PLOT TEXT, AT 59.5, -.15 : ".6"  PLOT TEXT, AT 98.5, -.15 : "1"  PLOT TEXT, AT  107, 0.05 : "x"  PLOT TEXT, AT 38.5,    2 : "1"  END SUB !PLOTFRAME61!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!