EXTERNAL             !PLOTSDOS.TRU!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB STARTUP		!( WINDOW1 )  DECLARE PUBLIC window1  WHEN exception in    IF STARTUPFLAG = 0 THEN      LET STARTUPFLAG = 1      CALL TC_Init		!("")       !Start True WINDOWS, prepare for window creation!      DECLARE DEF TW_wmake          !DEFINITION OF F'n to open a window      CALL TC_Win_Create(window1, "immune iconizable show", 0, 1, 0, 1)!      LET window1 = TW_wmake("immune")!      CALL TW_wset_current(window1, 0, 1, 0, 1)!      CALL TW_wset_visible(window1,1)!      CALL tw_wswitch(window1)      CALL TC_Win_SetTitle(window1, "Fourier System Plots Demonstration")      CALL TC_Win_Switch(window1)      CALL TC_Win_SetFont(window1, "terminal", 10, "plain")    END IF  USE     PRINT extext$     GET KEY x                    ! display error and wait  END WHENEND SUB !STARTUP!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB ERRORMESSAGE1( MESSAGE$ )  SOUND 500, .1  LET ICON = 3  LET BUTTON$ = "GO"  LET DEFAULT = 1  CALL TD_Warn( MESSAGE$, BUTTON$, DEFAULT, RESULT )END SUB !ERRORMESSAGE1!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PAINTMAINMENU( OPTION$ )  DECLARE PUBLIC window1  DIM menu$(2, 0:10)    !dimensioning for two menus, APPLE and MAIN MENU  MAT READ menu$                !loading the data for the menus  DATA       MAIN MENU@M  DATA       Fourier Series (Square Wave) @S  DATA       Fourier Series (Triangular Wave) @T  DATA       Telegraph Line 1 @1  DATA       Telegraph Line 2 @2  DATA       Wave Equation @W  DATA       RLC Filtering @R  DATA       Orthogonality @O  DATA       Discrete Orthogonality @D  DATA       @  DATA       Quit @Q  DATA       "INFO@I", "Info Page...@I", "", "", "", "", "", ""  DATA       "", "", ""  WHEN ERROR IN    CALL TC_Menu_SetEnable(window1, 1, 0, 1)    CALL TC_Menu_SetEnable(window1, 2, 0, 1)!    CALL TC_Menu_GetText(window1, 1,0, text$)  USE    CALL TC_Menu_Set(window1, menu$)  END WHEN!  CALL TW_menu_set(menu$)       !remove current menus, install menu$  DO    LET CYCLEFLAG = 0    DO      !      ! Here's our event loop      !     CALL TC_Event(0,type1$,window1,x1,x2)      SELECT CASE type1$      CASE "MENU"        !        ! Note what was selected        !        LET mitem$ = menu$(x1,x2)        LET p = Pos(mitem$,"@")        IF p > 0 then LET mitem$[p:maxnum] = ""   ! strip shortcuts        LET mtitle$ = menu$(x1,0)        IF X1 = 2 AND X2 = 1 THEN!          CALL TW_MENU_CLEAR          CALL BOX138!          CALL TW_menu_set(menu$)          LET CYCLEFLAG = 1        ELSE IF X1 = 1 THEN          IF  X2 = 1 THEN            LET OPTION$ = "A"          ELSE IF X2 = 2 THEN            LET OPTION$ = "B"          ELSE IF X2 = 3 THEN            LET OPTION$ = "C"          ELSE IF X2 = 4 THEN            LET OPTION$ = "D"          ELSE IF X2 = 5 THEN            LET OPTION$ = "E"          ELSE IF X2 = 6 THEN            LET OPTION$ = "F"          ELSE IF X2 = 7 THEN            LET OPTION$ = "G"          ELSE IF X2 = 8 THEN            LET OPTION$ = "H"          ELSE IF X2 = 10 THEN            LET OPTION$ = "Q"          END IF	  CALL TC_Menu_SetEnable(window1, 1, 0, 0)	  CALL TC_Menu_SetEnable(window1, 2, 0, 0)        END IF        EXIT DO      CASE "SINGLE"        SOUND 500, .1      CASE "DOUBLE"        SOUND 500, .1      CASE ELSE           !           ! Ignore other events           !      END SELECT    LOOP  LOOP WHILE CYCLEFLAG = 1!  CALL TW_MENU_CLEAREND SUB !BOX3!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB SHUTDOWNDECLARE PUBLIC window1CALL TC_Menu_Free(window1)CALL TC_Cleanup                   !shut down True Windows, kill all windows and!menu bars, restore True BASIC environmentEND SUB !SHUTDOWN!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB ADV  SET WINDOW 0, 81, 0, 25  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT 11   ,9    ; 11   ,21   ; 70   ,21    ; 70  ,9   ; 11  ,9  BOX AREA 11.5, 70.4, 8.85, 9  BOX AREA 70.0, 70.4, 8.85, 20.75  PLOT TEXT, AT 40,19:  "THIS IS A DEMONSTRATION DISK"  PLOT TEXT, AT 40,17:  "WHICH ACCOMPANIES THE TEXT"  PLOT TEXT, AT 40,15:  """INTRODUCTION TO FOURIER ANALYSIS"""  PLOT TEXT, AT 40,13:  "Norman Morrison"  PLOT TEXT, AT 40,11:  "JOHN WILEY & SONS"!  PLOT TEXT, AT 40,7:"click on APPLE to get the info page"END SUB !ADV!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB BOX138  DECLARE PUBLIC window1  CALL TC_Win_Create(window3, "show immune close",.05,.6,.2,.9)  CALL TC_Win_Switch(window3)  CALL TC_Win_SetTitle(window3, "Information on FFT System")  SET WINDOW 10,70,4,22  SET TEXT JUSTIFY "CENTER", "HALF"  CALL SHOWINFO  DO    LET TYPEA$ = "-"    CALL TC_Event( 0,TYPEA$, WINDOW, X1, X2 )    IF TYPEA$ = "HIDE" THEN      CALL TC_Free( window3 )      CALL TC_Win_Switch(window1)      EXIT DO    ELSE IF TYPEA$ = "SELECT" AND WINDOW = window1 THEN      CALL TC_Win_Active( window3 )      !SOUND 500,.1    END IF  LOOPEND SUB !BOX138!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB BOX107( WXY$ )  LET MESSAGE$ = "QUIT THE PLOTS SYSTEM ?"  LET ICON = 2  LET BUTTON$ = "YES|NO"  LET DEFAULT = 0  CALL TD_Warn( MESSAGE$, BUTTON$, DEFAULT, RESULT)  IF RESULT = 1 THEN    LET WXY$ = "Y"  ELSE IF RESULT = 2 THEN    LET WXY$ = "N"    CLEAR  END IFEND SUB !BOX107!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB SETCOLOR( COLOR$ )  SET COLOR "BLACK/WHITE"END SUB !SETCOLOR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB INPUTVALL( MESSAGE$, VALL, SHOWFLAG, FLAG )  DECLARE DEF EVAL  LET FLAG = 0  SET CURSOR "ON"  LET BUTTON$ = " GO |QUIT"  LET DEFAULT = 1  IF SHOWFLAG = 0 THEN    LET TEXT$ = ""  ELSE IF SHOWFLAG = 1 THEN    LET TEXT$ = STR$(VALL)  END IF  DO    CALL TD_Input(MESSAGE$, BUTTON$, TEXT$, DEFAULT, RESULT)    IF RESULT = 1 THEN      WHEN ERROR IN        LET VALL = EVAL(TEXT$)        EXIT DO      USE        SOUND 500, .1      END WHEN    ELSE IF RESULT = 2 THEN      LET FLAG = 1      EXIT DO    END IF  LOOP  SET CURSOR "OFF"END SUB !INPUTVALL!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB CQ( RESULT )  SET WINDOW 0, 81, 0, 31  BOX CLEAR  0, 81, 0,  3  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT TEXT, AT 33.5, 2: "CONTINUE"  PLOT 38,2.5 ; 40,2.5 ; 40,1.5 ; 38,1.5 ; 38,2.5  PLOT TEXT, AT 44.5, 2: "QUIT"  PLOT 47,2.5 ; 49,2.5 ; 49 ,1.5 ; 47,1.5 ; 47,2.5  DO    CALL TC_Event(TIMER, TYPE1$, WINDOW, X1, X2)    IF TYPE1$ = "SINGLE" THEN      IF X1>38 AND X1<40 AND X2>1.5 AND X2<2.5 THEN        CALL STAR(39,2)        LET RESULT = 1        EXIT DO      ELSE IF X1>47 AND X1<49 AND X2>1.5 AND X2<2.5 THEN        CALL STAR(48,2)        LET RESULT = 2        EXIT DO      ELSE        SOUND 500, .1      END IF    END IF  LOOP  BOX CLEAR  0, 81, 0,  3END SUB !CQ!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB CQ2( RESULT )  DECLARE PUBLIC window1  SET WINDOW 19, 61, 0, 31  BOX CLEAR  21, 59, 0,  3  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT TEXT, AT 33.5, 2: "CONTINUE"  PLOT 38,2.5 ; 40,2.5 ; 40,1.5 ; 38,1.5 ; 38,2.5  PLOT TEXT, AT 44.5, 2: "QUIT"  PLOT 47,2.5 ; 49,2.5 ; 49 ,1.5 ; 47,1.5 ; 47,2.5  CALL TC_Win_Active(window1)  DO    CALL TC_Event(TIMER, TYPE1$, WINDOW, X1, X2)    IF TYPE1$ = "SINGLE" THEN      IF X1>59.2 AND X1<61.2 AND X2>1.45 AND X2<2.4 THEN        CALL STAR(60,2)        LET RESULT = 1        EXIT DO      ELSE IF X1>67.8 AND X1<69.7 AND X2>1.45 AND X2<2.4 THEN        CALL STAR(69,2)        LET RESULT = 2        EXIT DO      ELSE!	print tab(1,1); x1;":";x2!	print tab(2,1); x1;":";x2        SOUND 500, .1      END IF    END IF  LOOP  BOX CLEAR  0, 81, 0,  3END SUB !CQ2!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB ASQ( RESULT )  !ANOTHER PLOT/START THE CLOCK/QUIT  SET WINDOW 0, 81, 0, 31  BOX CLEAR  0, 81, 28.5,  29.5  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT TEXT, AT 24.5, 29: "ANOTHER PLOT"  PLOT 31,29.5 ; 33,29.5 ; 33,28.5 ; 31,28.5 ; 31,29.5  PLOT TEXT, AT 42, 29: "START THE CLOCK"  PLOT 50,29.5 ; 52,29.5 ; 52,28.5 ; 50,28.5 ; 50,29.5  PLOT TEXT, AT 56.5, 29: "QUIT"  PLOT 59,29.5 ; 61,29.5 ; 61,28.5 ; 59,28.5 ; 59,29.5  DO    CALL TC_Event(TIMER, TYPE1$, WINDOW, X1, X2)    IF TYPE1$ = "SINGLE" THEN      IF X1>31 AND X1<33 AND X2>28.5 AND X2<29.5 THEN        CALL STAR(32,29)        LET RESULT = 1        EXIT DO      ELSE IF X1>50 AND X1<52 AND X2>28.5 AND X2<29.5 THEN        CALL STAR(51,29)        LET RESULT = 2        EXIT DO      ELSE IF X1>59 AND X1<61 AND X2>28.5 AND X2<29.5 THEN        CALL STAR(60,29)        LET RESULT = 3        EXIT DO      ELSE        SOUND 500, .1      END IF    END IF  LOOP  BOX CLEAR  0, 81, 28.5,  29.5END SUB !ASQ!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB AMQ( RESULT )  !AUTO/MANUAL/QUIT  SET WINDOW 0, 81, 0, 31  BOX CLEAR  0, 81, 28.5,  29.5  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT TEXT, AT 28.5, 29: "AUTO"  PLOT 31,29.5 ; 33,29.5 ; 33,28.5 ; 31,28.5 ; 31,29.5  PLOT TEXT, AT 38.5, 29: "MANUAL"  PLOT 42,29.5 ; 44,29.5 ; 44,28.5 ; 42,28.5 ; 42,29.5  PLOT TEXT, AT 48.5, 29: "QUIT"  PLOT 51,29.5 ; 53,29.5 ; 53,28.5 ; 51,28.5 ; 51,29.5  DO    CALL TC_Event(TIMER, TYPE1$, WINDOW, X1, X2)    IF TYPE1$ = "SINGLE" THEN      IF X1>31 AND X1<33 AND X2>28.5 AND X2<29.5 THEN        CALL STAR(32,29)        LET RESULT = 1        EXIT DO      ELSE IF X1>42 AND X1<44 AND X2>28.5 AND X2<29.5 THEN        CALL STAR(43,29)        LET RESULT = 2        EXIT DO      ELSE IF X1>51 AND X1<53 AND X2>28.5 AND X2<29.5 THEN        CALL STAR(52,29)        LET RESULT = 3        EXIT DO      ELSE        SOUND 500, .1      END IF    END IF  LOOP  BOX CLEAR  0, 81, 28.5,  29.5END SUB !AMQ!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB STAR(X,Y)  PLOT TEXT, AT X,Y : "*"  PAUSE .3END SUB !STAR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!