EXTERNAL !PLOTSUB2.TRU!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOT4( COLOR$ )  OPTION ANGLE RADIANS  DIM F(0:50,0:100)  DIM T(0:100)  LET SHOWFLAG = 1  DO    LET CLEARONCE = 1    LET CYCLE = 0    CLEAR    SET WINDOW 0, 81, 0, 31    SET TEXT JUSTIFY "CENTER", "HALF"    PLOT TEXT, AT 40, 30: "THIS PROGRAM PLOTS THE FUNCTION"    PLOT TEXT, AT 40, 28: "v(x)  =  1     (  0 < x < L )"    PLOT TEXT, AT 40, 25: "AND THEN USES IT AS THE INITIAL VOLTAGE ON A TELEGRAPH LINE"    PLOT TEXT, AT 40, 23: "WITH A SHORT-CIRCUIT TO GROUND AT EACH END"    SET WINDOW -.1, 1.1, -2.0, 9.5    PLOT  -.02, 2.3;    PLOT  1.02, 2.3    PLOT    0,  2.3;    PLOT    0,  3.3    PLOT    1,  2.3;    PLOT    1,  3.3    BOX AREA 0,1,3.27,3.32    BOX CLEAR .38,.62,3,3.5    PLOT TEXT, AT .5,3.3 : "telegraph line "    PLOT TEXT, AT 0.05,2.8 : "short"    PLOT TEXT, AT 0.95,2.8 : "short"    PLOT TEXT, AT 0,2.1 : "0"    PLOT TEXT, AT 1,2.1 : "L"    PLOT TEXT, AT 1.05,2.3 : "x"    CALL CQ( RESULT )    IF RESULT = 2 THEN LET GETOUT = 1    IF GETOUT = 0 THEN      LET MULT = 4/PI      DO        LET CYCLE  = 0        LET CYCLE2 = 0        LET CYCLE3 = 0        LET MESSAGE$ = "NUMBER OF TERMS IN FOURIER SERIES"        LET MESSAGE$ = MESSAGE$ & "|" & "  (a positive integer) ?"        LET HEB = 0        LET YSW = 0        DO          IF HEB = 1 THEN SOUND 500, .1          CALL INPUTVALL( MESSAGE$, K, SHOWFLAG, FLAG )          IF FLAG = 1 OR (K > 0 AND K = INT(K)) THEN LET YSW = 1          LET HEB = 1        LOOP UNTIL YSW = 1        IF FLAG = 1 THEN          LET CYCLE = 1          LET CYCLE2 = 1          LET CYCLE3 = 0          CALL CQ( RESULT )          IF RESULT = 2 THEN            LET CYCLE  = 0            LET CYCLE2 = 0            LET CYCLE3 = 1          END IF        END IF        IF CYCLE = 0 AND CYCLE3 = 0 THEN          IF CLEARONCE = 1 THEN            LET CLEARONCE = 0            CLEAR          END IF          CALL PLOTFRAME4          IF K > 30 THEN            LET STRING$ = "PLEASE WAIT...  PRESS SPACEBAR TO TERMINATE"            SET WINDOW 0, 81, 0, 31            BOX CLEAR 10, 70, 28.5, 29.5            PLOT TEXT, AT 40, 29 : STRING$            SET WINDOW -0.1, 1.1, -0.3, 1.8          END IF          LET YOLD = 0          LET Y = 1          FOR X = 0 TO .5 STEP 1/100            LET I = 100*X            LET F(I,YOLD) = F(I,Y)              ! SAVING THE PREVIOUS PLOT            LET F(I,Y) = 0            LET PIX = PI*X                      ! COMPUTING THE NEW PLOT            FOR N = 1 TO K              IF KEY INPUT THEN                GET KEY INKEY                IF INKEY = 32 THEN                  CLEAR                  CALL PLOTFRAME4                  LET CYCLE2 = 1                  EXIT FOR                END IF              ELSE                LET Z = 2*N-1                LET F(I,Y) =  F(I,Y) + MULT * SIN( Z*PIX ) / Z              END IF            NEXT N            IF CYCLE2 = 1 THEN EXIT FOR          NEXT X          IF CYCLE2 = 0 THEN            FOR X = .5 TO 0 STEP -1/100              IF KEY INPUT THEN                GET KEY INKEY                IF INKEY = 32 THEN                  CLEAR                  LET CYCLE2 = 1                  EXIT FOR                END IF              ELSE                LET I = 100*X                SET COLOR "WHITE"                 ! ERASING THE OLD PLOT                PLOT X, 0;                PLOT X, F(I,YOLD)                PLOT 1-X, 0;                PLOT 1-X, F(I,YOLD)                CALL SETCOLOR( COLOR$ )                PLOT X, 0;                PLOT X, F(I,Y)                PLOT 1-X, 0;                PLOT 1-X, F(I,Y)              END IF            NEXT X            CALL PLOTFRAME4            IF CYCLE2 = 0 THEN              IF K = 8 OR K = 11 OR K = 18 THEN                LET STRING$ = "THIS IS AN " &  STR$(K) & " TERM PLOT"              ELSE                LET STRING$ = "THIS IS A " & STR$(K)  & " TERM PLOT"              END IF              SET WINDOW 0, 81, 0, 31              BOX CLEAR 10, 70, 1, 3              PLOT TEXT, AT 40, 2 : STRING$              SET WINDOW -0.1, 1.1, -0.3, 1.8              DO                LET CYCLE3 = 0                CALL ASQ( RESULT )  !ANOTHER PLOT/START THE CLOCK/QUIT                IF RESULT = 1 THEN                  LET ZZ$ = "P"                ELSE IF RESULT = 2 THEN                  LET ZZ$ = "S"                ELSE IF RESULT = 3 THEN                  LET ZZ$ = "Q"                END IF                IF ZZ$ = "P" OR ZZ$ = "Q" THEN LET CYCLE2 = 1                IF CYCLE2 = 0 THEN                  BOX CLEAR .1,.9,-.2, -.05                  DO                    LET CYCLE4 = 0                    SET WINDOW 0, 81, 0, 31                    BOX CLEAR 10, 70, 28.5, 29.5                    PLOT TEXT, AT 40,29 : "THE FUNCTION SHOWN BELOW REPRESENTS THE INITIAL VOLTAGE ON THE LINE"                    SET WINDOW -0.1, 1.1, -0.3, 1.8                    LET MESSAGE$ = "HOW MANY PLOTS (a positive integer <100) ?"                    LET SWP = 0                    LET SZR = 0                    DO                      IF SWP = 1 THEN SOUND 500, .1                      CALL INPUTVALL( MESSAGE$, GG, SHOWFLAG, FLAG )                      IF FLAG = 1 OR (GG = INT(GG) AND GG > 0 AND GG <= 99) THEN LET SZR = 1                      LET SWP = 1                    LOOP UNTIL SZR = 1                    IF FLAG = 1 THEN    !QUIT                      LET CYCLE3 = 1                    END IF                    IF CYCLE3 = 0 THEN                      DO                        LET CYCLE5 = 0                        LET MESSAGE$ = "TIME GROWS LINEARLY OR EXPONENTIALLY ?"                        LET ICON = 2                        LET BUTTON$ = "LIN|EXP|QUIT"                        CALL TD_Warn(MESSAGE$, BUTTON$, DEFAULT, RESULT)                        IF RESULT = 1 THEN                          LET ZT$ = "L"                        ELSE IF RESULT = 2 THEN                          LET ZT$ = "E"                        ELSE IF RESULT = 3 THEN                          LET ZT$ = "Q"                        END IF                        IF ZT$ = "Q" THEN LET CYCLE4 = 1                        IF CYCLE4 = 0 THEN                          IF ZT$ = "L" THEN                            LET MESSAGE$ = "WHAT SIZE TIME STEP"                            LET MESSAGE$ = MESSAGE$ & "|" & "  (a positive number, try 1) ?"                            LET FUZ = 0                            LET GUZ = 0                            DO                              IF FUZ = 1 THEN SOUND 500, .1                              CALL INPUTVALL( MESSAGE$, AT, SHOWFLAG, FLAG )                              IF FLAG = 1 OR AT > 0 THEN LET GUZ = 1                              LET FUZ = 1                            LOOP UNTIL GUZ = 1                            LET DT = .01 * AT                            IF FLAG = 1 THEN LET CYCLE5 = 1                          ELSE IF ZT$ = "E" THEN                            LET MESSAGE$ = "WHAT VALUE FOR THE EXPONENT"                            LET MESSAGE$ = MESSAGE$ & "|" & "  (a number >1 and " & "<=" & " 2) ?"                            LET BUZ = 0                            LET RUZ = 0                            DO                              IF BUZ = 1 THEN SOUND 500, .1                              CALL INPUTVALL( MESSAGE$, BT, SHOWFLAG, FLAG )                              IF FLAG = 1 OR (BT > 1 AND BT <= 2) THEN LET RUZ = 1                              LET BUZ = 1                            LOOP UNTIL RUZ = 1                            LET DT = BT                            IF FLAG = 1 THEN LET CYCLE5 = 1                          END IF                          IF CYCLE5 = 0 THEN                            SET WINDOW 0, 81, 0, 31                            BOX CLEAR 0, 81, 25, 31                            BOX CLEAR 0, 81,  1,  3                            SET WINDOW -0.1, 1.1, -0.3, 1.8                            LET TT = 0                            LET GATE = 0                            FOR I = 0 TO 50                              LET F(I,0) = F(I,Y)                            NEXT I                            SET WINDOW 0, 81, 0, 31                            PLOT TEXT, AT 40,29 : "PLEASE WAIT... PRESS SPACEBAR TO TERMINATE"                            SET WINDOW -0.1, 1.1, -0.3, 1.8                            FOR Y = 1 TO GG           !GG IS NUMBER OF PLOTS                              FOR X = 0 TO .5 STEP 1/100    !X IS THE AXIS STEP                                LET I = 100*X                                LET F(I,Y) = 0                                LET PIX = PI*X                                FOR N = 1 TO K                                  IF KEY INPUT THEN                                    GET KEY INKEY                                    IF INKEY = 32 THEN                                      LET X = 0                                      LET Y = GG                                      CLEAR                                      CALL PLOTFRAME4                                      LET CYCLE2 = 1                                      EXIT FOR                                    END IF                                  ELSE                                    LET Z = 2*N-1                                    LET F(I,Y) = F(I,Y) + MULT * ( SIN(Z*PIX )/Z ) * EXP( -(Z^2*TT) )                                    IF EXP(- (Z^2*TT)) < 0.1 * EXP( -TT ) THEN LET N = K                                  END IF                                NEXT N                                IF CYCLE3 = 1 THEN EXIT FOR                              NEXT X                              IF CYCLE2 = 1 THEN                                EXIT FOR                              ELSE IF CYCLE2 = 0 THEN                                FOR X = .50 TO 0 STEP -1/100                                  IF KEY INPUT THEN                                    GET KEY INKEY                                    IF INKEY = 32 THEN                                      LET X = 0                                      LET Y = GG                                      CLEAR                                      CALL PLOTFRAME4                                      LET CYCLE2 = 1                                      EXIT FOR                                    END IF                                  END IF                                  LET I = 100*X                                  SET COLOR "WHITE"                                  PLOT X, 0;                                  PLOT X, F(I,Y-1)                                  PLOT 1-X, 0;                                  PLOT 1-X, F(I,Y-1)                                  CALL SETCOLOR( COLOR$ )                                  PLOT X, 0;                                  PLOT X, F(I,Y)                                  PLOT 1-X, 0;                                  PLOT 1-X, F(I,Y)                                NEXT X                              END IF                              IF CYCLE2 = 1 THEN                                EXIT FOR                              ELSE IF CYCLE2 = 0 THEN                                IF ZT$ = "L" THEN                                  LET T(Y) = 100*TT                                ELSE IF ZT$ = "E" THEN                                  LET T(Y) = INT(1000*TT + 0.5)/10                                END IF                                CALL SHOWVALS                                IF ZT$ = "L" THEN                                  LET TT = TT + DT                                ELSE IF ZT$ = "E" THEN                                  LET TT = DT*TT + .001                                END IF                              END IF                            NEXT Y                            IF CYCLE2 = 0 THEN                              DO                                LET CYCLE6 = 0                                CALL AMQ( RESULT )                                IF RESULT = 1 THEN                                  LET ZC$ = "A"                                ELSE IF RESULT = 2 THEN                                  LET ZC$ = "M"                                ELSE IF RESULT = 3 THEN                                  LET ZC$ = "Q"                                END IF                                IF ZC$ = "Q" THEN                                  LET CYCLE2 = 1                                  LET CLEARONCE = 1                                  CALL PLOTFRAME4                                ELSE IF ZC$ = "M" THEN                                  CLEAR                                  LET Y = 1                                  LET YOLD = 0                                  CALL PLOTFRAME4                                  DO                                    FOR X = .50 TO 0 STEP -1/100                                      LET I = 100*X                                      SET COLOR "WHITE"                                      PLOT X, 0;                                      PLOT X, F(I,YOLD)                                      PLOT 1-X, 0;                                      PLOT 1-X, F(I,YOLD)                                      CALL SETCOLOR( COLOR$ )                                      PLOT X, 0;                                      PLOT X, F(I,Y)                                      PLOT 1-X, 0;                                      PLOT 1-X, F(I,Y)                                    NEXT X                                    CALL SHOWVALS                                    CALL CQ( RESULT )                                    IF RESULT = 2 THEN EXIT DO                                    SET WINDOW -0.1, 1.1, -0.3, 1.8                                    LET MESSAGE$ = "POSITIVE OR NEGATIVE INTEGER"                                    LET RAT = 0                                    LET CAT = 0                                    DO                                      IF RAT = 1 THEN SOUND 500, .1                                      CALL INPUTVALL( MESSAGE$, DY, SHOWFLAG, FLAG )                                      IF FLAG = 1 OR DY = INT(DY) THEN LET CAT = 1                                      LET RAT = 1                                    LOOP UNTIL CAT = 1                                    LET YOLD = Y                                    LET Y = Y + DY                                    IF Y > GG THEN                                      LET Y = GG                                      SOUND 500, .1                                    ELSE IF Y < 1 THEN                                      LET Y = 1                                      SOUND 500, .1                                    END IF                                  LOOP UNTIL FLAG = 1                                  LET CYCLE6 = 1                                ELSE IF ZC$ = "A" THEN                                  CLEAR                                  SET WINDOW 0, 81, 0, 31                                  PLOT TEXT, AT 40,29 : "PRESS SPACEBAR TO TERMINATE"                                  CALL PLOTFRAME4                                  FOR Y = 1 TO GG                                    FOR X = .50 TO 0 STEP -1/100                                      LET I = 100*X                                      SET COLOR "WHITE"                                      PLOT X, 0;                                      PLOT X, F(I,Y-1)                                      PLOT 1-X, 0;                                      PLOT 1-X, F(I,Y-1)                                      CALL SETCOLOR( COLOR$ )                                      PLOT X, 0;                                      PLOT X, F(I,Y)                                      PLOT 1-X, 0;                                      PLOT 1-X, F(I,Y)                                      IF KEY INPUT THEN                                        GET KEY INKEY                                        IF INKEY = 32 THEN                                          LET CYCLE6 = 1                                          EXIT FOR                                        END IF                                      END IF                                    NEXT X                                    CALL SHOWVALS                                    IF CYCLE6 = 1 THEN EXIT FOR                                  NEXT Y                                  LET CYCLE6 = 1                                END IF                              LOOP WHILE CYCLE6 = 1                            END IF                          END IF                        END IF                      LOOP WHILE CYCLE5 = 1                    END IF                  LOOP WHILE CYCLE4 = 1                END IF              LOOP WHILE CYCLE3 = 1            END IF          END IF        END IF      LOOP WHILE CYCLE2 = 1    END IF  LOOP WHILE CYCLE = 1!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB SHOWVALS  CALL PLOTFRAME4  SET WINDOW 0, 81, 0, 31  BOX CLEAR 0, 81, 24, 28  LET STRING1$ = "PLOT " & STR$(Y) & " OF " & STR$(GG)  PLOT TEXT, AT 40, 27 : STRING1$  LET STRING2$ = "T = " & STR$(T(Y))  PLOT TEXT, AT 40, 25 : STRING2$  SET WINDOW -0.1, 1.1, -0.3, 1.8!  CALL TC_Event(TIMER, TYPE$,WINDOW, X1, X2)END SUB !SHOWVALS!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!END SUB !PLOT4!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!SUB PLOTFRAME4  SET WINDOW -0.1, 1.1, -0.3, 1.8  SET TEXT JUSTIFY "CENTER", "HALF"  PLOT -.03,  0;  PLOT 1.03,  0  PLOT   0,  -.07;  PLOT   0,  1  PLOT   1,  -.07;  PLOT   1,  1  PLOT   0,  1;  PLOT   1,  1  PLOT TEXT, AT -0.05,1   : "v(x)"  PLOT TEXT, AT -.02,0.05 : "0"  PLOT TEXT, AT 1.015,0.05 : "L"  PLOT TEXT, AT 1.04,0.01 : "x"END SUB !PLOTFRAME4!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!